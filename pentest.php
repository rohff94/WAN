<?php

include "./core/0.all.inc.php";


/*

 
wget https://raw.githubusercontent.com/disclose/disclose/master/program-list/program-list.json -O /tmp/program-list.json
cat /tmp/program-list.json | grep http | cut -d':' -f3 | sed "s#//##g" | sed "s#bugcrowd.com/##g" | sed "s#hackerone.com/##g" | cut -d'/' -f1 | sort -u | grep -Po -i "[0-9a-z_\-]{1,}\.[a-z]{2,5}$" | sort -u > /tmp/bounty.bugs
echo "# WAN" >> README.md
git init


git add README.md
git commit -m "first commit"
git remote add origin https://github.com/rohff94/WAN.git
git push -u origin master


  

  
 */


$start_file = __FILE__ ;
$start_file = trim(basename($start_file));
$start_file = str_replace("_", " ",$start_file);
$start_file = str_replace(".php","",$start_file);
$timestamp_debut = intro::start($start_file,"");


##############################################################################



if ( $argc != 3 ) {echo "Usage: ".__FILE__." 'SERVICE' 'PARAMS' ";exit(0);}

$service = strtoupper(trim($argv[1])) ;
switch ($service){
    
    
    case "DOMAIN" :
        // php parallel.php "cat /home/rohff/EH/CODE/POO/TMP/bounty.bugs | parallel --progress --no-notice -k -j2 php pentest.php DOMAIN {} " "tac /home/rohff/EH/CODE/POO/TMP/bounty.bugs | parallel --progress --no-notice -k -j2 php pentest.php DOMAIN {} " 0
        // php pentest.php DOMAIN "wlp5s0 ubisoft.com domain4pentest false"
        
        $params = trim($argv[2]) ;
        list($eth,$domain,$fonction,$flag_poc) = explode(" ", $params);
        $fonction = trim($fonction);
        $obj_domain = new DOMAIN($eth,$domain);
        $obj_domain->poc($flag_poc);
        echo $obj_domain->$fonction();
        break;
        
        
    case "HOST" :
        // for i in $(tac /tmp/wlp5s0.ubisoft.com.hosts | awk '{print $3}'); do php pentest.php HOST "wlp5s0 ubisoft.com $i host4pentest FALSE";done
        // for i in $(tac /tmp/wlp5s0.ubi.com.hosts | awk '{print $3}'); do php pentest.php HOST "wlp5s0 ubi.com $i host4pentest FALSE";done
        $params = trim($argv[2]) ;
        list($eth,$domain,$ip,$fonction,$flag_poc) = explode(" ", $params);
        $obj_ip = new HOST($eth,$domain,$ip);
        $fonction = trim($fonction);
        $obj_ip->poc($flag_poc);
        echo $obj_ip->$fonction();
        break;
        
        
    case "IP" :        
        // for i in $(cat /tmp/wlp5s0.ubisoft.com.ips | awk '{print $3}'); do php pentest.php IP "wlp5s0 ubisoft.com $i ip4service FALSE";done
        // for i in $(cat /tmp/wlp5s0.ubi.com.ips | awk '{print $3}'); do php pentest.php IP "wlp5s0 ubis.com $i ip4service FALSE";done
        // for i in 99.84.151.{1..254}; do php pentest.php IP "wlp5s0 ubisoft.com $i ip4service FALSE" ;done 
        $params = trim($argv[2]) ;
        list($eth,$domain,$ip,$fonction,$flag_poc) = explode(" ", $params);  
        $obj_ip = new IP($eth,$domain,$ip);
        $fonction = trim($fonction);
        $obj_ip->poc($flag_poc);
        echo $obj_ip->$fonction();
        break;
       
        
    case "PORT" :
        $params = trim($argv[2]) ;
        list($eth,$domain,$ip,$port,$protocol,$fonction,$flag_poc) = explode(" ", $params);
        $fonction = trim($fonction);
        $obj_port = new PORT($eth,$domain,$ip,$port,$protocol);
        $obj_port->poc($flag_poc);
        echo $obj_port->$fonction();
        break;
        
        
    case "SERVICE" :
        $params = trim($argv[2]) ;
        list($eth,$domain,$service_name,$protocol_search,$fonction2run,$flag_poc) = explode(" ", $params);
        $obj_service = new DOMAIN($eth,$domain);
        $obj_service->poc($flag_poc);
        echo $obj_service->domain2services($service_name,$protocol_search,$fonction2run);
        break;
 
        
        
    case "WEB" :
        $params = trim($argv[2]) ;
        list($eth,$domain,$url,$fonction,$flag_poc) = explode(" ", $params);
        $fonction = trim($fonction);
        $obj_url = new WEB($eth,$domain,$url);
        $obj_url->poc($flag_poc);
        echo $obj_url->$fonction();
        break;
        
        
    case "URL" :
        $params = trim($argv[2]) ;
        list($eth,$domain,$url,$fonction,$flag_poc) = explode(" ", $params);
        $fonction = trim($fonction);
        $obj_url = new URL($eth,$domain,$url);
        $obj_url->poc($flag_poc);
        echo $obj_url->$fonction();
        break;
                
        
    case "LAN" :
        $params = trim($argv[2]) ;
        $flag_poc = FALSE ;
        //$flag_poc = TRUE ;
        // $whois = "listening Server";
          var_dump($params);
        list($eth,$domain,$ip,$port,$protocol,$lport,$lprotocol,$templateB64_cmd,$templateB64_shell,$type,$timeout,$whois) = explode(" ", $params);
        $obj_server = new SERVICE4COM($eth,$domain,$ip,$port,$protocol);
        $obj_server->poc($flag_poc);
        if (stristr($type, "server")) echo $obj_server->stream8server($lport,$lprotocol,$templateB64_cmd,$templateB64_shell,$whois, $timeout);
        if (stristr($type, "client")) echo $obj_server->stream8client($lport,$lprotocol,$templateB64_cmd,$templateB64_shell,$whois, $timeout);
        break;
        
    case "FOR" :
        $params = trim($argv[2]) ;
        var_dump($params);
        list($type,$vmem_path,$profile) = explode(" ", $params);
        if ($type=="WIN") {
            $obj_vmem = new for4win($vmem_path,$profile);
            $filter = "";
            echo $obj_vmem->for4win_all($filter);
        }
        if ($type=="LINUX") {
            $obj_vmem = new for4linux($vmem_path,$profile);
            $filter = "";
            echo $obj_vmem->for4linux_all($filter);
        }

        break;
        
        
    default:
        {echo "Usage: ".__FILE__." '(IP || PORT || SERVICE)' 'PARAMS (IP || (PORT + PORT + PROTOCOL) || (SERVICE + PROTOCOL) )' \n";exit(0);}
        break;
}



//$obj_ip->requette("sudo chown -R $obj_ip->user_local:$obj_ip->user_local  $obj_ip->racine");
//echo $obj_ip->ip4pentest();

//$obj_ip->pause();





?>